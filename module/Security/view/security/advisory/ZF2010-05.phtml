<h2>ZF2010-05: Potential XSS vector in Zend_Service_ReCaptcha_MailHide</h2>

<h3>Executive Summary</h3>

<p>
    <code>Zend_Service_ReCaptcha_MailHide</code> had a potential XSS 
    vulnerability. Due to the fact that the email address was never validated, 
    and because its use of <code>htmlentities()</code> did not include the 
    encoding argument, it was potentially possible for a malicious user aware 
    of the issue to inject a specially crafted multibyte string as an attack 
    via the CAPTCHA's email argument.
</p>

<h3>Action Taken</h3>

<p>
    An <code>EmailAddress</code> validator was added by default to 
    <code>Zend_Service_ReCaptcha_MailHide</code> (which may be replaced with 
    any <code>Zend_Validate_interface</code> implementation), and the 
    submitted email address is now passed through this validator prior to 
    performing any markup generation. Additionally, accessors for setting and
    retrieving the encoding to use with <code>htmlentities()</code> have been
    provided, with a default value of UTF-8 used.
</p>

<h3>Recommendations</h3>

<p>
    If you use <code>Zend_Service_ReCaptcha_MailHide</code>, it is strongly 
    recommended that you upgrade to either the latest available Zend 
    Framework release, or one of the following releases, immediately:
</p>

<ul class="ul">
    <li>1.9.7</li>
    <li>1.8.5</li>
    <li>1.7.9</li>
</ul>

<h2>Other Information</h2>
<h3>Acknowledgments</h3>

<p>
    The Zend Framework team thanks the following for working with us to help 
    protect its users:
</p>

<ul class="ul">
    <li>PÃ¡draic Brady, who made the initial report and who worked with our 
    team to ensure that the appropriate actions were taken</li>
</ul>

<?php echo $this->render('security/policy'); ?>
