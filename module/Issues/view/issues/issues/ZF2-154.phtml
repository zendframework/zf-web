<h2>ZF2-154: Message will send with an empty body if only a single mime message body part is assigned</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2012-02-07T11:34:10.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2012-06-13T20:06:15.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Mario Dees (mariod)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Maks 3w (maks3w)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend\Mail</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF2-185">ZF2-185</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Sending a message that has setBody used with a string, or using a mime message with just a single body part will result in a message with an empty body all together.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Adam Lundrigan (adamlundrigan) on 2012-02-23T14:31:36.000+0000</p> 
        <div class="body">
            <p>Can you please provide a simple example which reproduces your issue?</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Mario Dees (mariod) on 2012-02-23T14:42:41.000+0000</p> 
        <div class="body">
            <p>I actually tested some more and it came down that it only did this with a specific mail server (smtp.1and1.com), the same code works just fine now with Postfix on localhost, I tried it not just with sendmail, but also the smtp adapter and it's okay. However zf1 type mail handling worked fine with 1and1 mail servers, so there must be something that fails during smtp communication with zf2 and those servers.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Philipp Kamps (fips) on 2012-05-01T13:30:18.000+0000</p> 
        <div class="body">
            <p>I can confirm that there are some problems around sending emails over different mail servers. Sometimes I end up receiving correct emails and sometimes (on different networks with a different mail delivery setups) I only receive broken messages. Here an example:</p>

<p>Delivered-To: name@domain.com
Received: by 10.52.165.162 with SMTP id yz2csp102219vdb;
        Tue, 1 May 2012 03:14:08 -0700 (PDT)
Received: by 10.14.119.197 with SMTP id n45mr4834496eeh.46.1335867248014;
        Tue, 01 May 2012 03:14:08 -0700 (PDT)
Return-Path: <a href="mailto:name@domain.com">name@domain.com</a>
Received: from localhost ([77.88.66.165])
        by mx.google.com with ESMTP id p48si5709352eef.113.2012.05.01.03.14.06;
        Tue, 01 May 2012 03:14:07 -0700 (PDT)
Received-SPF: softfail (google.com: domain of transitioning name@domain.com does not designate 77.88.66.165 as permitted sender) client-ip=77.88.66.165;
Authentication-Results: mx.google.com; spf=softfail (google.com: domain of transitioning name@name.com does not designate 77.88.66.165 as permitted sender) smtp.mail=name@domain.com
Message-Id: <a href="mailto:4f9fb76f.c85f0e0a.124c.ffffb0beSMTPIN_ADDED@mx.google.com">4f9fb76f.c85f0e0a.124c.ffffb0beSMTPIN_ADDED@mx.google.com</a>
Received: by localhost (Postfix, from userid 501)
    id 0756A179953E; Tue,  1 May 2012 12:13:47 +0200 (CEST)
To: name@domain.com
Subject: Daily History
X-PHP-Originating-Script: 501:Sendmail.php
Date: Tue, 01 May 2012 12:13:47 +0200</p>

<p>From: Philipp Kamps <a href="mailto:name@domain.com">name@domain.com</a></p>

<p>Subject: Daily History</p>

<p>Mime-Version: 1.0</p>

<p>Content-Type: multipart/mixed;</p>

<p>boundary="=_205e18960d7aaeee08a8cd6d7880a407"
Message-Id: &lt;20120501101349.0756A179953E@localhost&gt;</p>

<p>This is a message in Mime Format.  If you see this, your mail reader does not support this format.</p>

<p>--=_205e18960d7aaeee08a8cd6d7880a407
Content-Type: text/plain
Content-Transfer-Encoding: 8bit</p>

<p>Please see attachment.
--=_205e18960d7aaeee08a8cd6d7880a407
Content-Type: text/csv
Content-Transfer-Encoding: 8bit</p>

<p>--=_205e18960d7aaeee08a8cd6d7880a407
Content-Type: text/csv
Content-Transfer-Encoding: 8bit</p>

<p>.BUNLIL1
.DBCDIX
.DBODIX2
.DGLDIX
.JGBLIL1
.JGBSIL1
DFPINDEX
testbench5</p>

<p>--=_205e18960d7aaeee08a8cd6d7880a407--</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Maks 3w (maks3w) on 2012-06-12T16:14:31.000+0000</p> 
        <div class="body">
            <p>Probably this PR (<a href="https://github.com/zendframework/zf2/pull/1475">https://github.com/zendframework/zf2/pull/1475</a>) fix this Could someone test it?</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Maks 3w (maks3w) on 2012-06-13T20:06:15.000+0000</p> 
        <div class="body">
            <p>The PR has been merged, if the issue persists please reopen the issue.</p>

        </div>
    </div>
    </div>

