/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.atom.widget.FeedEntryEditor"],["require","dojox.atom.widget.FeedEntryViewer"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dijit._Container"],["require","dijit.Editor"],["require","dijit.form.TextBox"],["require","dijit.form.SimpleTextarea"],["requireLocalization","dojox.atom.widget","FeedEntryEditor",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"],["requireLocalization","dojox.atom.widget","PeopleEditor",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.atom.widget.FeedEntryEditor"]){_4._hasResource["dojox.atom.widget.FeedEntryEditor"]=true;_4.provide("dojox.atom.widget.FeedEntryEditor");_4.require("dojox.atom.widget.FeedEntryViewer");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dijit._Container");_4.require("dijit.Editor");_4.require("dijit.form.TextBox");_4.require("dijit.form.SimpleTextarea");_4.experimental("dojox.atom.widget.FeedEntryEditor");_4.declare("dojox.atom.widget.FeedEntryEditor",_6.atom.widget.FeedEntryViewer,{_contentEditor:null,_oldContent:null,_setObject:null,enableEdit:false,_contentEditorCreator:null,_editors:{},entryNewButton:null,_editable:false,templateString:_4.cache("dojox.atom","widget/templates/FeedEntryEditor.html","<div class=\"feedEntryViewer\">\n    <table border=\"0\" width=\"100%\" class=\"feedEntryViewerMenuTable\" dojoAttachPoint=\"feedEntryViewerMenu\" style=\"display: none;\">\n        <tr width=\"100%\"  dojoAttachPoint=\"entryCheckBoxDisplayOptions\">\n        \t<td align=\"left\" dojoAttachPoint=\"entryNewButton\">\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"doNew\" dojoAttachEvent=\"onclick:_toggleNew\"></span>\n        \t</td>\n            <td align=\"left\" dojoAttachPoint=\"entryEditButton\" style=\"display: none;\">\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"edit\" dojoAttachEvent=\"onclick:_toggleEdit\"></span>\n            </td>\n            <td align=\"left\" dojoAttachPoint=\"entrySaveCancelButtons\" style=\"display: none;\">\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"save\" dojoAttachEvent=\"onclick:saveEdits\"></span>\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"cancel\" dojoAttachEvent=\"onclick:cancelEdits\"></span>\n            </td>\n            <td align=\"right\">\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"displayOptions\" dojoAttachEvent=\"onclick:_toggleOptions\"></span>\n            </td>\n        </tr>\n        <tr class=\"feedEntryViewerDisplayCheckbox\" dojoAttachPoint=\"entryCheckBoxRow\" width=\"100%\" style=\"display: none;\">\n            <td dojoAttachPoint=\"feedEntryCelltitle\">\n                <input type=\"checkbox\" name=\"title\" value=\"Title\" dojoAttachPoint=\"feedEntryCheckBoxTitle\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelTitle\"></label>\n            </td>\n            <td dojoAttachPoint=\"feedEntryCellauthors\">\n                <input type=\"checkbox\" name=\"authors\" value=\"Authors\" dojoAttachPoint=\"feedEntryCheckBoxAuthors\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelAuthors\"></label>\n            </td>\n            <td dojoAttachPoint=\"feedEntryCellcontributors\">\n                <input type=\"checkbox\" name=\"contributors\" value=\"Contributors\" dojoAttachPoint=\"feedEntryCheckBoxContributors\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelContributors\"></label>\n            </td>\n            <td dojoAttachPoint=\"feedEntryCellid\">\n                <input type=\"checkbox\" name=\"id\" value=\"Id\" dojoAttachPoint=\"feedEntryCheckBoxId\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelId\"></label>\n            </td>\n            <td rowspan=\"2\" align=\"right\">\n                <span class=\"feedEntryViewerMenu\" dojoAttachPoint=\"close\" dojoAttachEvent=\"onclick:_toggleOptions\"></span>\n            </td>\n\t\t</tr>\n\t\t<tr class=\"feedEntryViewerDisplayCheckbox\" dojoAttachPoint=\"entryCheckBoxRow2\" width=\"100%\" style=\"display: none;\">\n            <td dojoAttachPoint=\"feedEntryCellupdated\">\n                <input type=\"checkbox\" name=\"updated\" value=\"Updated\" dojoAttachPoint=\"feedEntryCheckBoxUpdated\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelUpdated\"></label>\n            </td>\n            <td dojoAttachPoint=\"feedEntryCellsummary\">\n                <input type=\"checkbox\" name=\"summary\" value=\"Summary\" dojoAttachPoint=\"feedEntryCheckBoxSummary\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelSummary\"></label>\n            </td>\n            <td dojoAttachPoint=\"feedEntryCellcontent\">\n                <input type=\"checkbox\" name=\"content\" value=\"Content\" dojoAttachPoint=\"feedEntryCheckBoxContent\" dojoAttachEvent=\"onclick:_toggleCheckbox\"/>\n\t\t\t\t<label for=\"title\" dojoAttachPoint=\"feedEntryCheckBoxLabelContent\"></label>\n            </td>\n        </tr>\n    </table>\n    \n    <table class=\"feedEntryViewerContainer\" border=\"0\" width=\"100%\">\n        <tr class=\"feedEntryViewerTitle\" dojoAttachPoint=\"entryTitleRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryTitleHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        \t<select dojoAttachPoint=\"entryTitleSelect\" dojoAttachEvent=\"onchange:_switchEditor\" style=\"display: none\">\n                        \t\t<option value=\"text\">Text</option>\n\t\t\t\t\t\t\t\t<option value=\"html\">HTML</option>\n\t\t\t\t\t\t\t\t<option value=\"xhtml\">XHTML</option>\n                        \t</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" dojoAttachPoint=\"entryTitleNode\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n        <tr class=\"feedEntryViewerAuthor\" dojoAttachPoint=\"entryAuthorRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryAuthorHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entryAuthorNode\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n        <tr class=\"feedEntryViewerContributor\" dojoAttachPoint=\"entryContributorRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryContributorHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entryContributorNode\" class=\"feedEntryViewerContributorNames\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        \n        <tr class=\"feedEntryViewerId\" dojoAttachPoint=\"entryIdRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryIdHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entryIdNode\" class=\"feedEntryViewerIdText\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class=\"feedEntryViewerUpdated\" dojoAttachPoint=\"entryUpdatedRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryUpdatedHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entryUpdatedNode\" class=\"feedEntryViewerUpdatedText\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class=\"feedEntryViewerSummary\" dojoAttachPoint=\"entrySummaryRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\" colspan=\"2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entrySummaryHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        \t<select dojoAttachPoint=\"entrySummarySelect\" dojoAttachEvent=\"onchange:_switchEditor\" style=\"display: none\">\n                        \t\t<option value=\"text\">Text</option>\n\t\t\t\t\t\t\t\t<option value=\"html\">HTML</option>\n\t\t\t\t\t\t\t\t<option value=\"xhtml\">XHTML</option>\n                        \t</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entrySummaryNode\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class=\"feedEntryViewerContent\" dojoAttachPoint=\"entryContentRow\" style=\"display: none;\">\n            <td>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                    <tr class=\"graphic-tab-lgray\">\n\t\t\t\t\t\t<td class=\"lp2\">\n\t\t\t\t\t\t\t<span class=\"lp\" dojoAttachPoint=\"entryContentHeader\"></span>\n\t\t\t\t\t\t</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        \t<select dojoAttachPoint=\"entryContentSelect\" dojoAttachEvent=\"onchange:_switchEditor\" style=\"display: none\">\n                        \t\t<option value=\"text\">Text</option>\n\t\t\t\t\t\t\t\t<option value=\"html\">HTML</option>\n\t\t\t\t\t\t\t\t<option value=\"xhtml\">XHTML</option>\n                        \t</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint=\"entryContentNode\">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</div>\n"),postCreate:function(){if(this.entrySelectionTopic!==""){this._subscriptions=[_4.subscribe(this.entrySelectionTopic,this,"_handleEvent")];}var _7=_4.i18n.getLocalization("dojox.atom.widget","FeedEntryViewer");this.displayOptions.innerHTML=_7.displayOptions;this.feedEntryCheckBoxLabelTitle.innerHTML=_7.title;this.feedEntryCheckBoxLabelAuthors.innerHTML=_7.authors;this.feedEntryCheckBoxLabelContributors.innerHTML=_7.contributors;this.feedEntryCheckBoxLabelId.innerHTML=_7.id;this.close.innerHTML=_7.close;this.feedEntryCheckBoxLabelUpdated.innerHTML=_7.updated;this.feedEntryCheckBoxLabelSummary.innerHTML=_7.summary;this.feedEntryCheckBoxLabelContent.innerHTML=_7.content;_7=_4.i18n.getLocalization("dojox.atom.widget","FeedEntryEditor");this.doNew.innerHTML=_7.doNew;this.edit.innerHTML=_7.edit;this.save.innerHTML=_7.save;this.cancel.innerHTML=_7.cancel;},setEntry:function(_8,_9,_a){if(this._entry!==_8){this._editMode=false;_a=false;}else{_a=true;}_6.atom.widget.FeedEntryEditor.superclass.setEntry.call(this,_8,_9);this._editable=this._isEditable(_8);if(!_a&&!this._editable){_4.style(this.entryEditButton,"display","none");_4.style(this.entrySaveCancelButtons,"display","none");}if(this._editable&&this.enableEdit){if(!_a){_4.style(this.entryEditButton,"display","");if(this.enableMenuFade&&this.entrySaveCancelButton){_4.fadeOut({node:this.entrySaveCancelButton,duration:250}).play();}}}},_toggleEdit:function(){if(this._editable&&this.enableEdit){_4.style(this.entryEditButton,"display","none");_4.style(this.entrySaveCancelButtons,"display","");this._editMode=true;this.setEntry(this._entry,this._feed,true);}},_handleEvent:function(_b){if(_b.source!=this&&_b.action=="delete"&&_b.entry&&_b.entry==this._entry){_4.style(this.entryEditButton,"display","none");}_6.atom.widget.FeedEntryEditor.superclass._handleEvent.call(this,_b);},_isEditable:function(_c){var _d=false;if(_c&&_c!==null&&_c.links&&_c.links!==null){for(var x in _c.links){if(_c.links[x].rel&&_c.links[x].rel=="edit"){_d=true;break;}}}return _d;},setTitle:function(_e,_f,_10){if(!_f){_6.atom.widget.FeedEntryEditor.superclass.setTitle.call(this,_e,_f,_10);if(_10.title&&_10.title.value&&_10.title.value!==null){this.setFieldValidity("title",true);}}else{if(_10.title&&_10.title.value&&_10.title.value!==null){if(!this._toLoad){this._toLoad=[];}this.entryTitleSelect.value=_10.title.type;var _11=this._createEditor(_e,_10.title,true,_10.title.type==="html"||_10.title.type==="xhtml");_11.name="title";this._toLoad.push(_11);this.setFieldValidity("titleedit",true);this.setFieldValidity("title",true);}}},setAuthors:function(_12,_13,_14){if(!_13){_6.atom.widget.FeedEntryEditor.superclass.setAuthors.call(this,_12,_13,_14);if(_14.authors&&_14.authors.length>0){this.setFieldValidity("authors",true);}}else{if(_14.authors&&_14.authors.length>0){this._editors.authors=this._createPeopleEditor(this.entryAuthorNode,{data:_14.authors,name:"Author"});this.setFieldValidity("authors",true);}}},setContributors:function(_15,_16,_17){if(!_16){_6.atom.widget.FeedEntryEditor.superclass.setContributors.call(this,_15,_16,_17);if(_17.contributors&&_17.contributors.length>0){this.setFieldValidity("contributors",true);}}else{if(_17.contributors&&_17.contributors.length>0){this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{data:_17.contributors,name:"Contributor"});this.setFieldValidity("contributors",true);}}},setId:function(_18,_19,_1a){if(!_19){_6.atom.widget.FeedEntryEditor.superclass.setId.call(this,_18,_19,_1a);if(_1a.id&&_1a.id!==null){this.setFieldValidity("id",true);}}else{if(_1a.id&&_1a.id!==null){this._editors.id=this._createEditor(_18,_1a.id);this.setFieldValidity("id",true);}}},setUpdated:function(_1b,_1c,_1d){if(!_1c){_6.atom.widget.FeedEntryEditor.superclass.setUpdated.call(this,_1b,_1c,_1d);if(_1d.updated&&_1d.updated!==null){this.setFieldValidity("updated",true);}}else{if(_1d.updated&&_1d.updated!==null){this._editors.updated=this._createEditor(_1b,_1d.updated);this.setFieldValidity("updated",true);}}},setSummary:function(_1e,_1f,_20){if(!_1f){_6.atom.widget.FeedEntryEditor.superclass.setSummary.call(this,_1e,_1f,_20);if(_20.summary&&_20.summary.value&&_20.summary.value!==null){this.setFieldValidity("summary",true);}}else{if(_20.summary&&_20.summary.value&&_20.summary.value!==null){if(!this._toLoad){this._toLoad=[];}this.entrySummarySelect.value=_20.summary.type;var _21=this._createEditor(_1e,_20.summary,true,_20.summary.type==="html"||_20.summary.type==="xhtml");_21.name="summary";this._toLoad.push(_21);this.setFieldValidity("summaryedit",true);this.setFieldValidity("summary",true);}}},setContent:function(_22,_23,_24){if(!_23){_6.atom.widget.FeedEntryEditor.superclass.setContent.call(this,_22,_23,_24);if(_24.content&&_24.content.value&&_24.content.value!==null){this.setFieldValidity("content",true);}}else{if(_24.content&&_24.content.value&&_24.content.value!==null){if(!this._toLoad){this._toLoad=[];}this.entryContentSelect.value=_24.content.type;var _25=this._createEditor(_22,_24.content,true,_24.content.type==="html"||_24.content.type==="xhtml");_25.name="content";this._toLoad.push(_25);this.setFieldValidity("contentedit",true);this.setFieldValidity("content",true);}}},_createEditor:function(_26,_27,_28,rte){var _29;var box;if(!_27){if(rte){return {anchorNode:_26,entryValue:"",editor:null,generateEditor:function(){var _2a=document.createElement("div");_2a.innerHTML=this.entryValue;this.anchorNode.appendChild(_2a);var _2b=new _5.Editor({},_2a);this.editor=_2b;return _2b;}};}if(_28){_29=document.createElement("textarea");_26.appendChild(_29);_4.style(_29,"width","90%");box=new _5.form.SimpleTextarea({},_29);}else{_29=document.createElement("input");_26.appendChild(_29);_4.style(_29,"width","95%");box=new _5.form.TextBox({},_29);}box.attr("value","");return box;}var _2c;if(_27.value!==undefined){_2c=_27.value;}else{if(_27.attr){_2c=_27.attr("value");}else{_2c=_27;}}if(rte){if(_2c.indexOf("<")!=-1){_2c=_2c.replace(/</g,"&lt;");}return {anchorNode:_26,entryValue:_2c,editor:null,generateEditor:function(){var _2d=document.createElement("div");_2d.innerHTML=this.entryValue;this.anchorNode.appendChild(_2d);var _2e=new _5.Editor({},_2d);this.editor=_2e;return _2e;}};}if(_28){_29=document.createElement("textarea");_26.appendChild(_29);_4.style(_29,"width","90%");box=new _5.form.SimpleTextarea({},_29);}else{_29=document.createElement("input");_26.appendChild(_29);_4.style(_29,"width","95%");box=new _5.form.TextBox({},_29);}box.attr("value",_2c);return box;},_switchEditor:function(_2f){var _30=null;var _31=null;var _32=null;if(_4.isIE){_31=_2f.srcElement;}else{_31=_2f.target;}if(_31===this.entryTitleSelect){_32=this.entryTitleNode;_30="title";}else{if(_31===this.entrySummarySelect){_32=this.entrySummaryNode;_30="summary";}else{_32=this.entryContentNode;_30="content";}}var _33=this._editors[_30];var _34;var _35;if(_31.value==="text"){if(_33.declaredClass==="dijit.Editor"){_35=_33.attr("value",false);_33.close(false,true);_33.destroy();while(_32.firstChild){_4.destroy(_32.firstChild);}_34=this._createEditor(_32,{value:_35},true,false);this._editors[_30]=_34;}}else{if(_33.declaredClass!="dijit.Editor"){_35=_33.attr("value");_33.destroy();while(_32.firstChild){_4.destroy(_32.firstChild);}_34=this._createEditor(_32,{value:_35},true,true);_34=_4.hitch(_34,_34.generateEditor)();this._editors[_30]=_34;}}},_createPeopleEditor:function(_36,_37){var _38=document.createElement("div");_36.appendChild(_38);return new _6.atom.widget.PeopleEditor(_37,_38);},saveEdits:function(){_4.style(this.entrySaveCancelButtons,"display","none");_4.style(this.entryEditButton,"display","");_4.style(this.entryNewButton,"display","");var _39=false;var _3a;var i;var _3b;var _3c;var _3d;var _3e;if(!this._new){_3c=this.getEntry();if(this._editors.title&&(this._editors.title.attr("value")!=_3c.title.value||this.entryTitleSelect.value!=_3c.title.type)){_3a=this._editors.title.attr("value");if(this.entryTitleSelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);if(_3a.indexOf("<div xmlns=\"http://www.w3.org/1999/xhtml\">")!==0){_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}}_3c.title=new _6.atom.io.model.Content("title",_3a,null,this.entryTitleSelect.value);_39=true;}if(this._editors.id.attr("value")!=_3c.id){_3c.id=this._editors.id.attr("value");_39=true;}if(this._editors.summary&&(this._editors.summary.attr("value")!=_3c.summary.value||this.entrySummarySelect.value!=_3c.summary.type)){_3a=this._editors.summary.attr("value");if(this.entrySummarySelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);if(_3a.indexOf("<div xmlns=\"http://www.w3.org/1999/xhtml\">")!==0){_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}}_3c.summary=new _6.atom.io.model.Content("summary",_3a,null,this.entrySummarySelect.value);_39=true;}if(this._editors.content&&(this._editors.content.attr("value")!=_3c.content.value||this.entryContentSelect.value!=_3c.content.type)){_3a=this._editors.content.attr("value");if(this.entryContentSelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);if(_3a.indexOf("<div xmlns=\"http://www.w3.org/1999/xhtml\">")!==0){_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}}_3c.content=new _6.atom.io.model.Content("content",_3a,null,this.entryContentSelect.value);_39=true;}if(this._editors.authors){if(_39){_3c.authors=[];_3d=this._editors.authors.getValues();for(i in _3d){if(_3d[i].name||_3d[i].email||_3d[i].uri){_3c.addAuthor(_3d[i].name,_3d[i].email,_3d[i].uri);}}}else{var _3f=_3c.authors;var _40=function(_41,_42,uri){for(i in _3f){if(_3f[i].name===_41&&_3f[i].email===_42&&_3f[i].uri===uri){return true;}}return false;};_3d=this._editors.authors.getValues();_3b=false;for(i in _3d){if(!_40(_3d[i].name,_3d[i].email,_3d[i].uri)){_3b=true;break;}}if(_3b){_3c.authors=[];for(i in _3d){if(_3d[i].name||_3d[i].email||_3d[i].uri){_3c.addAuthor(_3d[i].name,_3d[i].email,_3d[i].uri);}}_39=true;}}}if(this._editors.contributors){if(_39){_3c.contributors=[];_3e=this._editors.contributors.getValues();for(i in _3e){if(_3e[i].name||_3e[i].email||_3e[i].uri){_3c.addAuthor(_3e[i].name,_3e[i].email,_3e[i].uri);}}}else{var _43=_3c.contributors;var _44=function(_45,_46,uri){for(i in _43){if(_43[i].name===_45&&_43[i].email===_46&&_43[i].uri===uri){return true;}}return false;};_3e=this._editors.contributors.getValues();_3b=false;for(i in _3e){if(_44(_3e[i].name,_3e[i].email,_3e[i].uri)){_3b=true;break;}}if(_3b){_3c.contributors=[];for(i in _3e){if(_3e[i].name||_3e[i].email||_3e[i].uri){_3c.addContributor(_3e[i].name,_3e[i].email,_3e[i].uri);}}_39=true;}}}if(_39){_4.publish(this.entrySelectionTopic,[{action:"update",source:this,entry:_3c,callback:this._handleSave}]);}}else{this._new=false;_3c=new _6.atom.io.model.Entry();_3a=this._editors.title.attr("value");if(this.entryTitleSelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}_3c.setTitle(_3a,this.entryTitleSelect.value);_3c.id=this._editors.id.attr("value");_3d=this._editors.authors.getValues();for(i in _3d){if(_3d[i].name||_3d[i].email||_3d[i].uri){_3c.addAuthor(_3d[i].name,_3d[i].email,_3d[i].uri);}}_3e=this._editors.contributors.getValues();for(i in _3e){if(_3e[i].name||_3e[i].email||_3e[i].uri){_3c.addContributor(_3e[i].name,_3e[i].email,_3e[i].uri);}}_3a=this._editors.summary.attr("value");if(this.entrySummarySelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}_3c.summary=new _6.atom.io.model.Content("summary",_3a,null,this.entrySummarySelect.value);_3a=this._editors.content.attr("value");if(this.entryContentSelect.value==="xhtml"){_3a=this._enforceXhtml(_3a);_3a="<div xmlns=\"http://www.w3.org/1999/xhtml\">"+_3a+"</div>";}_3c.content=new _6.atom.io.model.Content("content",_3a,null,this.entryContentSelect.value);_4.style(this.entryNewButton,"display","");_4.publish(this.entrySelectionTopic,[{action:"post",source:this,entry:_3c}]);}this._editMode=false;this.setEntry(_3c,this._feed,true);},_handleSave:function(_47,_48){this._editMode=false;this.clear();this.setEntry(_47,this.getFeed(),true);},cancelEdits:function(){this._new=false;_4.style(this.entrySaveCancelButtons,"display","none");if(this._editable){_4.style(this.entryEditButton,"display","");}_4.style(this.entryNewButton,"display","");this._editMode=false;this.clearEditors();this.setEntry(this.getEntry(),this.getFeed(),true);},clear:function(){this._editable=false;this.clearEditors();_6.atom.widget.FeedEntryEditor.superclass.clear.apply(this);if(this._contentEditor){this._contentEditor=this._setObject=this._oldContent=this._contentEditorCreator=null;this._editors={};}},clearEditors:function(){for(var key in this._editors){if(this._editors[key].declaredClass==="dijit.Editor"){this._editors[key].close(false,true);}this._editors[key].destroy();}this._editors={};},_enforceXhtml:function(_49){var _4a=null;if(_49){var _4b=/<br>/g;_4a=_49.replace(_4b,"<br/>");_4a=this._closeTag(_4a,"hr");_4a=this._closeTag(_4a,"img");}return _4a;},_closeTag:function(_4c,tag){var _4d="<"+tag;var _4e=_4c.indexOf(_4d);if(_4e!==-1){while(_4e!==-1){var _4f="";var _50=false;for(var i=0;i<_4c.length;i++){var c=_4c.charAt(i);if(i<=_4e||_50){_4f+=c;}else{if(c===">"){_4f+="/";_50=true;}_4f+=c;}}_4c=_4f;_4e=_4c.indexOf(_4d,_4e+1);}}return _4c;},_toggleNew:function(){_4.style(this.entryNewButton,"display","none");_4.style(this.entryEditButton,"display","none");_4.style(this.entrySaveCancelButtons,"display","");this.entrySummarySelect.value="text";this.entryContentSelect.value="text";this.entryTitleSelect.value="text";this.clearNodes();this._new=true;var _51=_4.i18n.getLocalization("dojox.atom.widget","FeedEntryViewer");var _52=new _6.atom.widget.EntryHeader({title:_51.title});this.entryTitleHeader.appendChild(_52.domNode);this._editors.title=this._createEditor(this.entryTitleNode,null);this.setFieldValidity("title",true);var _53=new _6.atom.widget.EntryHeader({title:_51.authors});this.entryAuthorHeader.appendChild(_53.domNode);this._editors.authors=this._createPeopleEditor(this.entryAuthorNode,{name:"Author"});this.setFieldValidity("authors",true);var _54=new _6.atom.widget.EntryHeader({title:_51.contributors});this.entryContributorHeader.appendChild(_54.domNode);this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{name:"Contributor"});this.setFieldValidity("contributors",true);var _55=new _6.atom.widget.EntryHeader({title:_51.id});this.entryIdHeader.appendChild(_55.domNode);this._editors.id=this._createEditor(this.entryIdNode,null);this.setFieldValidity("id",true);var _56=new _6.atom.widget.EntryHeader({title:_51.updated});this.entryUpdatedHeader.appendChild(_56.domNode);this._editors.updated=this._createEditor(this.entryUpdatedNode,null);this.setFieldValidity("updated",true);var _57=new _6.atom.widget.EntryHeader({title:_51.summary});this.entrySummaryHeader.appendChild(_57.domNode);this._editors.summary=this._createEditor(this.entrySummaryNode,null,true);this.setFieldValidity("summaryedit",true);this.setFieldValidity("summary",true);var _58=new _6.atom.widget.EntryHeader({title:_51.content});this.entryContentHeader.appendChild(_58.domNode);this._editors.content=this._createEditor(this.entryContentNode,null,true);this.setFieldValidity("contentedit",true);this.setFieldValidity("content",true);this._displaySections();},_displaySections:function(){_4.style(this.entrySummarySelect,"display","none");_4.style(this.entryContentSelect,"display","none");_4.style(this.entryTitleSelect,"display","none");if(this.isFieldValid("contentedit")){_4.style(this.entryContentSelect,"display","");}if(this.isFieldValid("summaryedit")){_4.style(this.entrySummarySelect,"display","");}if(this.isFieldValid("titleedit")){_4.style(this.entryTitleSelect,"display","");}_6.atom.widget.FeedEntryEditor.superclass._displaySections.apply(this);if(this._toLoad){for(var i in this._toLoad){var _59;if(this._toLoad[i].generateEditor){_59=_4.hitch(this._toLoad[i],this._toLoad[i].generateEditor)();}else{_59=this._toLoad[i];}this._editors[this._toLoad[i].name]=_59;this._toLoad[i]=null;}this._toLoad=null;}}});_4.declare("dojox.atom.widget.PeopleEditor",[_5._Widget,_5._Templated,_5._Container],{templateString:_4.cache("dojox.atom","widget/templates/PeopleEditor.html","<div class=\"peopleEditor\">\n\t<table style=\"width: 100%\">\n\t\t<tbody dojoAttachPoint=\"peopleEditorEditors\"></tbody>\n\t</table>\n\t<span class=\"peopleEditorButton\" dojoAttachPoint=\"peopleEditorButton\" dojoAttachEvent=\"onclick:_add\"></span>\n</div>\n"),_rows:[],_editors:[],_index:0,_numRows:0,postCreate:function(){var _5a=_4.i18n.getLocalization("dojox.atom.widget","PeopleEditor");if(this.name){if(this.name=="Author"){this.peopleEditorButton.appendChild(document.createTextNode("["+_5a.addAuthor+"]"));}else{if(this.name=="Contributor"){this.peopleEditorButton.appendChild(document.createTextNode("["+_5a.addContributor+"]"));}}}else{this.peopleEditorButton.appendChild(document.createTextNode("["+_5a.add+"]"));}this._editors=[];if(!this.data||this.data.length===0){this._createEditors(null,null,null,0,this.name);this._index=1;}else{for(var i in this.data){this._createEditors(this.data[i].name,this.data[i].email,this.data[i].uri,i);this._index++;this._numRows++;}}},destroy:function(){for(var key in this._editors){for(var _5b in this._editors[key]){this._editors[key][_5b].destroy();}}this._editors=[];},_createEditors:function(_5c,_5d,uri,_5e,_5f){var row=document.createElement("tr");this.peopleEditorEditors.appendChild(row);row.id="removeRow"+_5e;var _60=document.createElement("td");_60.setAttribute("align","right");row.appendChild(_60);_60.colSpan=2;if(this._numRows>0){var hr=document.createElement("hr");_60.appendChild(hr);hr.id="hr"+_5e;}row=document.createElement("span");_60.appendChild(row);row.className="peopleEditorButton";_4.style(row,"font-size","x-small");_4.connect(row,"onclick",this,"_removeEditor");row.id="remove"+_5e;_60=document.createTextNode("[X]");row.appendChild(_60);row=document.createElement("tr");this.peopleEditorEditors.appendChild(row);row.id="editorsRow"+_5e;var _61=document.createElement("td");row.appendChild(_61);_4.style(_61,"width","20%");_60=document.createElement("td");row.appendChild(_60);row=document.createElement("table");_61.appendChild(row);_4.style(row,"width","100%");_61=document.createElement("tbody");row.appendChild(_61);row=document.createElement("table");_60.appendChild(row);_4.style(row,"width","100%");_60=document.createElement("tbody");row.appendChild(_60);this._editors[_5e]=[];this._editors[_5e].push(this._createEditor(_5c,_5f+"name"+_5e,"Name:",_61,_60));this._editors[_5e].push(this._createEditor(_5d,_5f+"email"+_5e,"Email:",_61,_60));this._editors[_5e].push(this._createEditor(uri,_5f+"uri"+_5e,"URI:",_61,_60));},_createEditor:function(_62,id,_63,_64,_65){var row=document.createElement("tr");_64.appendChild(row);var _66=document.createElement("label");_66.setAttribute("for",id);_66.appendChild(document.createTextNode(_63));_64=document.createElement("td");_64.appendChild(_66);row.appendChild(_64);row=document.createElement("tr");_65.appendChild(row);_65=document.createElement("td");row.appendChild(_65);var _67=document.createElement("input");_67.setAttribute("id",id);_65.appendChild(_67);_4.style(_67,"width","95%");var box=new _5.form.TextBox({},_67);box.attr("value",_62);return box;},_removeEditor:function(_68){var _69=null;if(_4.isIE){_69=_68.srcElement;}else{_69=_68.target;}var id=_69.id;id=id.substring(6);for(var key in this._editors[id]){this._editors[id][key].destroy();}var _6a=_4.byId("editorsRow"+id);var _6b=_6a.parentNode;_6b.removeChild(_6a);_6a=_4.byId("removeRow"+id);_6b=_6a.parentNode;_6b.removeChild(_6a);this._numRows--;if(this._numRows===1&&_6b.firstChild.firstChild.firstChild.tagName.toLowerCase()==="hr"){_6a=_6b.firstChild.firstChild;_6a.removeChild(_6a.firstChild);}this._editors[id]=null;},_add:function(){this._createEditors(null,null,null,this._index);this._index++;this._numRows++;},getValues:function(){var _6c=[];for(var i in this._editors){if(this._editors[i]){_6c.push({name:this._editors[i][0].attr("value"),email:this._editors[i][1].attr("value"),uri:this._editors[i][2].attr("value")});}}return _6c;}});}}};});