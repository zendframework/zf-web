/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.drawing.manager.Canvas"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.drawing.manager.Canvas"]){_4._hasResource["dojox.drawing.manager.Canvas"]=true;_4.provide("dojox.drawing.manager.Canvas");(function(){_6.drawing.manager.Canvas=_6.drawing.util.oo.declare(function(_7){_4.mixin(this,_7);var _8=_4.contentBox(this.srcRefNode);this.height=this.parentHeight=_8.h;this.width=this.parentWidth=_8.w;this.domNode=_4.create("div",{id:"canvasNode"},this.srcRefNode);_4.style(this.domNode,{width:this.width,height:"auto"});_4.setSelectable(this.domNode,false);this.id=this.id||this.util.uid("surface");console.info("create canvas");this.gfxSurface=_6.gfx.createSurface(this.domNode,this.width,this.height);this.gfxSurface.whenLoaded(this,function(){setTimeout(_4.hitch(this,function(){this.surfaceReady=true;if(_4.isIE){}else{if(_6.gfx.renderer=="silverlight"){this.id=this.domNode.firstChild.id;}else{}}this.underlay=this.gfxSurface.createGroup();this.surface=this.gfxSurface.createGroup();this.overlay=this.gfxSurface.createGroup();this.surface.setTransform({dx:0,dy:0,xx:1,yy:1});this.gfxSurface.getDimensions=_4.hitch(this.gfxSurface,"getDimensions");if(_7.callback){_7.callback(this.domNode);}}),500);});this._mouseHandle=this.mouse.register(this);},{zoom:1,useScrollbars:true,baseClass:"drawingCanvas",resize:function(_9,_a){this.parentWidth=_9;this.parentHeight=_a;this.setDimensions(_9,_a);},setDimensions:function(_b,_c,_d,_e){var sw=this.getScrollWidth();this.width=Math.max(_b,this.parentWidth);this.height=Math.max(_c,this.parentHeight);if(this.height>this.parentHeight){this.width-=sw;}if(this.width>this.parentWidth){this.height-=sw;}this.gfxSurface.setDimensions(this.width,this.height);this.domNode.parentNode.scrollTop=_e||0;this.domNode.parentNode.scrollLeft=_d||0;if(this.useScrollbars){_4.style(this.domNode.parentNode,{overflowY:this.height>this.parentHeight?"scroll":"hidden",overflowX:this.width>this.parentWidth?"scroll":"hidden"});}else{_4.style(this.domNode.parentNode,{overflowY:"hidden",overflowX:"hidden"});}},setZoom:function(_f){this.zoom=_f;this.surface.setTransform({xx:_f,yy:_f});this.setDimensions(this.width*_f,this.height*_f);},onScroll:function(){},getScrollOffset:function(){return {top:this.domNode.parentNode.scrollTop,left:this.domNode.parentNode.scrollLeft};},getScrollWidth:function(){var p=_4.create("div");p.innerHTML="<div style=\"width:50px;height:50px;overflow:hidden;position:absolute;top:0px;left:-1000px;\"><div style=\"height:100px;\"></div>";var div=p.firstChild;_4.body().appendChild(div);var _10=_4.contentBox(div).h;_4.style(div,"overflow","scroll");var _11=_10-_4.contentBox(div).h;_4.destroy(div);this.getScrollWidth=function(){return _11;};return _11;}});})();}}};});