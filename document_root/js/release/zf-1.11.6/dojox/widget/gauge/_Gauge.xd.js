/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.widget.gauge._Gauge"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dijit._Container"],["require","dijit._Contained"],["require","dijit.Tooltip"],["require","dojo.fx.easing"],["require","dojox.gfx"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.widget.gauge._Gauge"]){_4._hasResource["dojox.widget.gauge._Gauge"]=true;_4.provide("dojox.widget.gauge._Gauge");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dijit._Container");_4.require("dijit._Contained");_4.require("dijit.Tooltip");_4.require("dojo.fx.easing");_4.require("dojox.gfx");_4.experimental("dojox.widget.gauge._Gauge");_4.declare("dojox.widget.gauge._Gauge",[_5._Widget,_5._Templated,_5._Container],{width:0,height:0,background:null,min:0,max:0,image:null,useRangeStyles:0,useTooltip:true,majorTicks:null,minorTicks:null,_defaultIndicator:null,defaultColors:[[0,84,170,1],[68,119,187,1],[102,153,204,1],[153,187,238,1],[153,204,255,1],[204,238,255,1],[221,238,255,1]],min:null,max:null,surface:null,hideValues:false,gaugeContent:undefined,templateString:_4.cache("dojox.widget.gauge","_Gauge.html","<div>\n\t<div class=\"dojoxGaugeContent\" dojoAttachPoint=\"gaugeContent\"></div>\n\t<div dojoAttachPoint=\"containerNode\"></div>\n\t<div dojoAttachPoint=\"mouseNode\"></div>\n</div>\n"),_backgroundDefault:{color:"#E0E0E0"},_rangeData:null,_indicatorData:null,_drag:null,_img:null,_overOverlay:false,_lastHover:"",startup:function(){if(this.image===null){this.image={};}this.connect(this.gaugeContent,"onmousemove",this.handleMouseMove);this.connect(this.gaugeContent,"onmouseover",this.handleMouseOver);this.connect(this.gaugeContent,"onmouseout",this.handleMouseOut);this.connect(this.gaugeContent,"onmouseup",this.handleMouseUp);if(!_4.isArray(this.ranges)){this.ranges=[];}if(!_4.isArray(this.indicators)){this.indicators=[];}var _7=[],_8=[];var i;if(this.hasChildren()){var _9=this.getChildren();for(i=0;i<_9.length;i++){if(/dojox\.widget\..*Indicator/.test(_9[i].declaredClass)){_8.push(_9[i]);continue;}switch(_9[i].declaredClass){case "dojox.widget.gauge.Range":_7.push(_9[i]);break;}}this.ranges=this.ranges.concat(_7);this.indicators=this.indicators.concat(_8);}if(!this.background){this.background=this._backgroundDefault;}this.background=this.background.color||this.background;if(!this.surface){this.createSurface();}this.addRanges(this.ranges);if(this.minorTicks&&this.minorTicks.interval){this.setMinorTicks(this.minorTicks);}if(this.majorTicks&&this.majorTicks.interval){this.setMajorTicks(this.majorTicks);}for(i=0;i<this.indicators.length;i++){this.addIndicator(this.indicators[i]);}},_setTicks:function(_a,_b,_c){var i;if(_a&&_4.isArray(_a._ticks)){for(i=0;i<_a._ticks.length;i++){this.removeIndicator(_a._ticks[i]);}}var t={length:_b.length,offset:_b.offset,noChange:true};if(_b.color){t.color=_b.color;}if(_b.font){t.font=_b.font;}_b._ticks=[];for(i=this.min;i<=this.max;i+=_b.interval){t.value=i;if(_c){t.label=""+i;}_b._ticks.push(this.addIndicator(t));}return _b;},setMinorTicks:function(_d){this.minorTicks=this._setTicks(this.minorTicks,_d,false);},setMajorTicks:function(_e){this.majorTicks=this._setTicks(this.majorTicks,_e,true);},postCreate:function(){if(this.hideValues){_4.style(this.containerNode,"display","none");}_4.style(this.mouseNode,"width","0");_4.style(this.mouseNode,"height","0");_4.style(this.mouseNode,"position","absolute");_4.style(this.mouseNode,"z-index","100");if(this.useTooltip){_5.showTooltip("test",this.mouseNode);_5.hideTooltip(this.mouseNode);}},createSurface:function(){this.gaugeContent.style.width=this.width+"px";this.gaugeContent.style.height=this.height+"px";this.surface=_6.gfx.createSurface(this.gaugeContent,this.width,this.height);this._background=this.surface.createRect({x:0,y:0,width:this.width,height:this.height});this._background.setFill(this.background);if(this.image.url){this._img=this.surface.createImage({width:this.image.width||this.width,height:this.image.height||this.height,src:this.image.url});if(this.image.overlay){this._img.getEventSource().setAttribute("overlay",true);}if(this.image.x||this.image.y){this._img.setTransform({dx:this.image.x||0,dy:this.image.y||0});}}},setBackground:function(_f){if(!_f){_f=this._backgroundDefault;}this.background=_f.color||_f;this._background.setFill(this.background);},addRange:function(_10){this.addRanges([_10]);},addRanges:function(_11){if(!this._rangeData){this._rangeData=[];}var _12;for(var i=0;i<_11.length;i++){_12=_11[i];if((this.min===null)||(_12.low<this.min)){this.min=_12.low;}if((this.max===null)||(_12.high>this.max)){this.max=_12.high;}if(!_12.color){var _13=this._rangeData.length%this.defaultColors.length;if(_6.gfx.svg&&this.useRangeStyles>0){_13=(this._rangeData.length%this.useRangeStyles)+1;_12.color={style:"dojoxGaugeRange"+_13};}else{_13=this._rangeData.length%this.defaultColors.length;_12.color=this.defaultColors[_13];}}this._rangeData[this._rangeData.length]=_12;}this.draw();},addIndicator:function(_14){_14._gauge=this;if(!_14.declaredClass){_14=new this._defaultIndicator(_14);}if(!_14.hideValue){this.containerNode.appendChild(_14.domNode);}if(!this._indicatorData){this._indicatorData=[];}this._indicatorData[this._indicatorData.length]=_14;_14.draw();return _14;},removeIndicator:function(_15){for(var i=0;i<this._indicatorData.length;i++){if(this._indicatorData[i]===_15){this._indicatorData.splice(i,1);_15.remove();break;}}},moveIndicatorToFront:function(_16){if(_16.shapes){for(var i=0;i<_16.shapes.length;i++){_16.shapes[i].moveToFront();}}},drawText:function(txt,x,y,_17,_18,_19,_1a){var t=this.surface.createText({x:x,y:y,text:txt,align:_17});t.setFill(_19);t.setFont(_1a);return t;},removeText:function(t){this.surface.rawNode.removeChild(t);},updateTooltip:function(txt,e){if(this._lastHover!=txt){if(txt!==""){_5.hideTooltip(this.mouseNode);_5.showTooltip(txt,this.mouseNode);}else{_5.hideTooltip(this.mouseNode);}this._lastHover=txt;}},handleMouseOver:function(_1b){var _1c=_1b.target.getAttribute("hover");if(_1b.target.getAttribute("overlay")){this._overOverlay=true;var r=this.getRangeUnderMouse(_1b);if(r&&r.hover){_1c=r.hover;}}if(this.useTooltip&&!this._drag){if(_1c){this.updateTooltip(_1c,_1b);}else{this.updateTooltip("",_1b);}}},handleMouseOut:function(_1d){if(_1d.target.getAttribute("overlay")){this._overOverlay=false;}if(this.useTooltip&&this.mouseNode){_5.hideTooltip(this.mouseNode);}},handleMouseDown:function(_1e){for(var i=0;i<this._indicatorData.length;i++){var _1f=this._indicatorData[i].shapes;for(var s=0;s<_1f.length;s++){if(_1f[s].getEventSource()==_1e.target){this._drag=this._indicatorData[i];s=_1f.length;i=this._indicatorData.length;}}}_4.stopEvent(_1e);},handleMouseUp:function(_20){this._drag=null;_4.stopEvent(_20);},handleMouseMove:function(_21){if(_21){_4.style(this.mouseNode,"left",_21.pageX+1+"px");_4.style(this.mouseNode,"top",_21.pageY+1+"px");}if(this._drag){this._dragIndicator(this,_21);}else{if(this.useTooltip&&this._overOverlay){var r=this.getRangeUnderMouse(_21);if(r&&r.hover){this.updateTooltip(r.hover,_21);}else{this.updateTooltip("",_21);}}}}});_4.declare("dojox.widget.gauge.Range",[_5._Widget,_5._Contained],{low:0,high:0,hover:"",color:null,size:0,startup:function(){this.color=this.color.color||this.color;}});_4.declare("dojox.widget.gauge._Indicator",[_5._Widget,_5._Contained,_5._Templated],{value:0,type:"",color:"black",label:"",font:{family:"sans-serif",size:"12px"},length:0,width:0,offset:0,hover:"",front:false,easing:_4._defaultEasing,duration:1000,hideValue:false,noChange:false,_gauge:null,title:"",templateString:_4.cache("dojox.widget.gauge","_Indicator.html","<div class=\"dojoxGaugeIndicatorDiv\">\n\t<label class=\"dojoxGaugeIndicatorLabel\" for=\"${title}\">${title}:</label>\n\t<input class=\"dojoxGaugeIndicatorInput\" name=\"${title}\" size=\"5\" value=\"${value}\" dojoAttachPoint=\"valueNode\" dojoAttachEvent=\"onchange:_update\"></input>\n</div>\n"),startup:function(){if(this.onDragMove){this.onDragMove=_4.hitch(this.onDragMove);}},postCreate:function(){if(this.title===""){_4.style(this.domNode,"display","none");}if(_4.isString(this.easing)){this.easing=_4.getObject(this.easing);}},_update:function(_22){var _23=this.valueNode.value;if(_23===""){this.value=null;}else{this.value=Number(_23);this.hover=this.title+": "+_23;}if(this._gauge){this.draw();this.valueNode.value=this.value;if((this.title=="Target"||this.front)&&this._gauge.moveIndicator){this._gauge.moveIndicatorToFront(this);}}},update:function(_24){if(!this.noChange){this.valueNode.value=_24;this._update();}},onDragMove:function(){this.value=Math.floor(this.value);this.valueNode.value=this.value;this.hover=this.title+": "+this.value;},draw:function(_25){},remove:function(){for(var i=0;i<this.shapes.length;i++){this._gauge.surface.remove(this.shapes[i]);}if(this.text){this._gauge.surface.remove(this.text);}}});}}};});