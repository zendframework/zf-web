/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.drawing.manager.keys"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.drawing.manager.keys"]){_4._hasResource["dojox.drawing.manager.keys"]=true;_4.provide("dojox.drawing.manager.keys");(function(){var _7=false;var _8=true;var _9="abcdefghijklmnopqrstuvwxyz";_6.drawing.manager.keys={arrowIncrement:1,arrowShiftIncrement:10,shift:false,ctrl:false,alt:false,cmmd:false,meta:false,onDelete:function(_a){},onEsc:function(_b){},onEnter:function(_c){},onArrow:function(_d){},onKeyDown:function(_e){},onKeyUp:function(_f){},listeners:[],register:function(_10){var _11=_6.drawing.util.uid("listener");this.listeners.push({handle:_11,scope:_10.scope||window,callback:_10.callback,keyCode:_10.keyCode});},_getLetter:function(evt){if(!evt.meta&&evt.keyCode>=65&&evt.keyCode<=90){return _9.charAt(evt.keyCode-65);}return null;},_mixin:function(evt){evt.meta=this.meta;evt.shift=this.shift;evt.alt=this.alt;evt.cmmd=this.cmmd;evt.letter=this._getLetter(evt);return evt;},editMode:function(_12){_7=_12;},enable:function(_13){_8=_13;},scanForFields:function(){if(this._fieldCons){_4.forEach(this._fieldCons,_4.disconnect,_4);}this._fieldCons=[];_4.query("input").forEach(function(n){var a=_4.connect(n,"focus",this,function(evt){this.enable(false);});var b=_4.connect(n,"blur",this,function(evt){this.enable(true);});this._fieldCons.push(a);this._fieldCons.push(b);},this);},init:function(){setTimeout(_4.hitch(this,"scanForFields"),500);_4.connect(document,"blur",this,function(evt){this.meta=this.shift=this.ctrl=this.cmmd=this.alt=false;});_4.connect(document,"keydown",this,function(evt){if(!_8){return;}if(evt.keyCode==16){this.shift=true;}if(evt.keyCode==17){this.ctrl=true;}if(evt.keyCode==18){this.alt=true;}if(evt.keyCode==224){this.cmmd=true;}this.meta=this.shift||this.ctrl||this.cmmd||this.alt;if(!_7){this.onKeyDown(this._mixin(evt));if(evt.keyCode==8||evt.keyCode==46){_4.stopEvent(evt);}}});_4.connect(document,"keyup",this,function(evt){if(!_8){return;}var _14=false;if(evt.keyCode==16){this.shift=false;}if(evt.keyCode==17){this.ctrl=false;}if(evt.keyCode==18){this.alt=false;}if(evt.keyCode==224){this.cmmd=false;}this.meta=this.shift||this.ctrl||this.cmmd||this.alt;!_7&&this.onKeyUp(this._mixin(evt));if(evt.keyCode==13){console.warn("KEY ENTER");this.onEnter(evt);_14=true;}if(evt.keyCode==27){this.onEsc(evt);_14=true;}if(evt.keyCode==8||evt.keyCode==46){this.onDelete(evt);_14=true;}if(_14&&!_7){_4.stopEvent(evt);}});_4.connect(document,"keypress",this,function(evt){if(!_8){return;}var inc=this.shift?this.arrowIncrement*this.arrowShiftIncrement:this.arrowIncrement;var x=0,y=0;if(evt.keyCode==32&&!_7){_4.stopEvent(evt);}if(evt.keyCode==37){x=-inc;}if(evt.keyCode==38){y=-inc;}if(evt.keyCode==39){x=inc;}if(evt.keyCode==40){y=inc;}if(x||y){evt.x=x;evt.y=y;evt.shift=this.shift;this.onArrow(evt);if(!_7){_4.stopEvent(evt);}}});}};_4.addOnLoad(_6.drawing.manager.keys,"init");})();}}};});