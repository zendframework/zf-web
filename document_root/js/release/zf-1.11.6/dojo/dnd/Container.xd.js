/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo.dnd.Container"],["require","dojo.dnd.common"],["require","dojo.parser"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo.dnd.Container"]){_4._hasResource["dojo.dnd.Container"]=true;_4.provide("dojo.dnd.Container");_4.require("dojo.dnd.common");_4.require("dojo.parser");_4.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(_7,_8){this.node=_4.byId(_7);if(!_8){_8={};}this.creator=_8.creator||null;this.skipForm=_8.skipForm;this.parent=_8.dropParent&&_4.byId(_8.dropParent);this.map={};this.current=null;this.containerState="";_4.addClass(this.node,"dojoDndContainer");if(!(_8&&_8._skipStartup)){this.startup();}this.events=[_4.connect(this.node,"onmouseover",this,"onMouseOver"),_4.connect(this.node,"onmouseout",this,"onMouseOut"),_4.connect(this.node,"ondragstart",this,"onSelectStart"),_4.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(_9){return this.map[_9];},setItem:function(_a,_b){this.map[_a]=_b;},delItem:function(_c){delete this.map[_c];},forInItems:function(f,o){o=o||_4.global;var m=this.map,e=_4.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _4.query("> .dojoDndItem",this.parent);},sync:function(){var _d={};this.getAllNodes().forEach(function(_e){if(_e.id){var _f=this.getItem(_e.id);if(_f){_d[_e.id]=_f;return;}}else{_e.id=_4.dnd.getUniqueId();}var _10=_e.getAttribute("dndType"),_11=_e.getAttribute("dndData");_d[_e.id]={data:_11||_e.innerHTML,type:_10?_10.split(/\s*,\s*/):["text"]};},this);this.map=_d;return this;},insertNodes:function(_12,_13,_14){if(!this.parent.firstChild){_14=null;}else{if(_13){if(!_14){_14=this.parent.firstChild;}}else{if(_14){_14=_14.nextSibling;}}}if(_14){for(var i=0;i<_12.length;++i){var t=this._normalizedCreator(_12[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_14);}}else{for(var i=0;i<_12.length;++i){var t=this._normalizedCreator(_12[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_4.forEach(this.events,_4.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_15,_16){_15._skipStartup=true;return new _4.dnd.Container(_16,_15);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=_4.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!_4.dnd.isFormElement(e)){_4.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(_17,_18){var _19="dojoDnd"+_17;var _1a=_17.toLowerCase()+"State";_4.removeClass(this.node,_19+this[_1a]);_4.addClass(this.node,_19+_18);this[_1a]=_18;},_addItemClass:function(_1b,_1c){_4.addClass(_1b,"dojoDndItem"+_1c);},_removeItemClass:function(_1d,_1e){_4.removeClass(_1d,"dojoDndItem"+_1e);},_getChildByEvent:function(e){var _1f=e.target;if(_1f){for(var _20=_1f.parentNode;_20;_1f=_20,_20=_1f.parentNode){if(_20==this.parent&&_4.hasClass(_1f,"dojoDndItem")){return _1f;}}}return null;},_normalizedCreator:function(_21,_22){var t=(this.creator||this.defaultCreator).call(this,_21,_22);if(!_4.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=_4.dnd.getUniqueId();}_4.addClass(t.node,"dojoDndItem");return t;}});_4.dnd._createNode=function(tag){if(!tag){return _4.dnd._createSpan;}return function(_23){return _4.create(tag,{innerHTML:_23});};};_4.dnd._createTrTd=function(_24){var tr=_4.create("tr");_4.create("td",{innerHTML:_24},tr);return tr;};_4.dnd._createSpan=function(_25){return _4.create("span",{innerHTML:_25});};_4.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};_4.dnd._defaultCreator=function(_26){var tag=_26.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?_4.dnd._createTrTd:_4.dnd._createNode(_4.dnd._defaultCreatorNodes[tag]);return function(_27,_28){var _29=_27&&_4.isObject(_27),_2a,_2b,n;if(_29&&_27.tagName&&_27.nodeType&&_27.getAttribute){_2a=_27.getAttribute("dndData")||_27.innerHTML;_2b=_27.getAttribute("dndType");_2b=_2b?_2b.split(/\s*,\s*/):["text"];n=_27;}else{_2a=(_29&&_27.data)?_27.data:_27;_2b=(_29&&_27.type)?_27.type:["text"];n=(_28=="avatar"?_4.dnd._createSpan:c)(String(_2a));}n.id=_4.dnd.getUniqueId();return {node:n,data:_2a,type:_2b};};};}}};});